{"version":3,"sources":["useNormalizedSnapPoints.ts"],"names":["useDerivedValue","normalizeSnapPoint","INITIAL_CONTAINER_HEIGHT","INITIAL_HANDLE_HEIGHT","INITIAL_SNAP_POINT","useNormalizedSnapPoints","snapPoints","containerHeight","contentHeight","handleHeight","enableDynamicSizing","maxDynamicContentSize","normalizedSnapPoints","isContainerLayoutReady","value","_snapPoints","_normalizedSnapPoints","map","snapPoint","push","Math","min","undefined","sort","a","b"],"mappings":"AAAA,SAAmBA,eAAnB,QAA0C,yBAA1C;AACA,SAASC,kBAAT,QAAmC,cAAnC;AAEA,SACEC,wBADF,EAEEC,qBAFF,EAGEC,kBAHF,QAIO,qCAJP;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,uBAAuB,GAAG,CACrCC,UADqC,EAErCC,eAFqC,EAGrCC,aAHqC,EAIrCC,YAJqC,EAKrCC,mBALqC,EAMrCC,qBANqC,KAOlC;AACH,QAAMC,oBAAoB,GAAGZ,eAAe,CAAC,MAAM;AACjD;AACA,UAAMa,sBAAsB,GAC1BN,eAAe,CAACO,KAAhB,KAA0BZ,wBAD5B;;AAEA,QAAI,CAACW,sBAAL,EAA6B;AAC3B,aAAO,CAACT,kBAAD,CAAP;AACD;;AAED,UAAMW,WAAW,GAAGT,UAAU,GAC1B,WAAWA,UAAX,GACEA,UAAU,CAACQ,KADb,GAEER,UAHwB,GAI1B,EAJJ;;AAMA,QAAIU,qBAAqB,GAAGD,WAAW,CAACE,GAAZ,CAAgBC,SAAS,IACnDjB,kBAAkB,CAACiB,SAAD,EAAYX,eAAe,CAACO,KAA5B,CADQ,CAA5B;;AAIA,QAAIJ,mBAAJ,EAAyB;AACvB,UAAID,YAAY,CAACK,KAAb,KAAuBX,qBAA3B,EAAkD;AAChD,eAAO,CAACC,kBAAD,CAAP;AACD;;AAED,UAAII,aAAa,CAACM,KAAd,KAAwBZ,wBAA5B,EAAsD;AACpD,eAAO,CAACE,kBAAD,CAAP;AACD;;AAEDY,MAAAA,qBAAqB,CAACG,IAAtB,CACEZ,eAAe,CAACO,KAAhB,GACEM,IAAI,CAACC,GAAL,CACEb,aAAa,CAACM,KAAd,GAAsBL,YAAY,CAACK,KADrC,EAEEH,qBAAqB,KAAKW,SAA1B,GACIX,qBADJ,GAEIJ,eAAe,CAACO,KAJtB,CAFJ;;AAUAE,MAAAA,qBAAqB,GAAGA,qBAAqB,CAACO,IAAtB,CAA2B,CAACC,CAAD,EAAIC,CAAJ,KAAUA,CAAC,GAAGD,CAAzC,CAAxB;AACD;;AACD,WAAOR,qBAAP;AACD,GAxC2C,EAwCzC,CAACV,UAAD,EAAaI,mBAAb,EAAkCC,qBAAlC,CAxCyC,CAA5C;AA0CA,SAAOC,oBAAP;AACD,CAnDM","sourcesContent":["import Animated, { useDerivedValue } from 'react-native-reanimated';\nimport { normalizeSnapPoint } from '../utilities';\nimport type { BottomSheetProps } from '../components/bottomSheet';\nimport {\n  INITIAL_CONTAINER_HEIGHT,\n  INITIAL_HANDLE_HEIGHT,\n  INITIAL_SNAP_POINT,\n} from '../components/bottomSheet/constants';\n\n/**\n * Convert percentage snap points to pixels in screen and calculate\n * the accurate snap points positions.\n * @param snapPoints provided snap points.\n * @param containerHeight BottomSheetContainer height.\n * @param contentHeight content size.\n * @param handleHeight handle size.\n * @param enableDynamicSizing\n * @param maxDynamicContentSize\n * @returns {Animated.SharedValue<number[]>}\n */\nexport const useNormalizedSnapPoints = (\n  snapPoints: BottomSheetProps['snapPoints'],\n  containerHeight: Animated.SharedValue<number>,\n  contentHeight: Animated.SharedValue<number>,\n  handleHeight: Animated.SharedValue<number>,\n  enableDynamicSizing: BottomSheetProps['enableDynamicSizing'],\n  maxDynamicContentSize: BottomSheetProps['maxDynamicContentSize']\n) => {\n  const normalizedSnapPoints = useDerivedValue(() => {\n    // early exit, if container layout is not ready\n    const isContainerLayoutReady =\n      containerHeight.value !== INITIAL_CONTAINER_HEIGHT;\n    if (!isContainerLayoutReady) {\n      return [INITIAL_SNAP_POINT];\n    }\n\n    const _snapPoints = snapPoints\n      ? 'value' in snapPoints\n        ? snapPoints.value\n        : snapPoints\n      : [];\n\n    let _normalizedSnapPoints = _snapPoints.map(snapPoint =>\n      normalizeSnapPoint(snapPoint, containerHeight.value)\n    ) as number[];\n\n    if (enableDynamicSizing) {\n      if (handleHeight.value === INITIAL_HANDLE_HEIGHT) {\n        return [INITIAL_SNAP_POINT];\n      }\n\n      if (contentHeight.value === INITIAL_CONTAINER_HEIGHT) {\n        return [INITIAL_SNAP_POINT];\n      }\n\n      _normalizedSnapPoints.push(\n        containerHeight.value -\n          Math.min(\n            contentHeight.value + handleHeight.value,\n            maxDynamicContentSize !== undefined\n              ? maxDynamicContentSize\n              : containerHeight.value\n          )\n      );\n\n      _normalizedSnapPoints = _normalizedSnapPoints.sort((a, b) => b - a);\n    }\n    return _normalizedSnapPoints;\n  }, [snapPoints, enableDynamicSizing, maxDynamicContentSize]);\n\n  return normalizedSnapPoints;\n};\n"]}