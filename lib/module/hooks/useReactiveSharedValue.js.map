{"version":3,"sources":["useReactiveSharedValue.ts"],"names":["useEffect","useRef","cancelAnimation","makeMutable","useReactiveSharedValue","value","initialValueRef","valueRef","current"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,MAApB,QAAkC,OAAlC;AACA,SACEC,eADF,EAEEC,WAFF,QAGO,yBAHP;AAMA,OAAO,MAAMC,sBAAsB,GACjCC,KADoC,IAEkB;AAAA;;AACtD,QAAMC,eAAe,GAAGL,MAAM,CAAI,IAAJ,CAA9B;AACA,QAAMM,QAAQ,GAAGN,MAAM,CAA0B,IAA1B,CAAvB;;AAEA,MAAII,KAAK,IAAI,OAAOA,KAAP,KAAiB,QAA1B,IAAsC,WAAWA,KAArD,EAA4D;AAC1D;AACJ;AACA;AACA;AACG,GALD,MAKO,IAAIE,QAAQ,CAACC,OAAT,KAAqB,IAAzB,EAA+B;AACpC;AACAF,IAAAA,eAAe,CAACE,OAAhB,GAA0BH,KAA1B;AACA;AACJ;AACA;AACA;;AACI,QAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmBL,WAAW,CAAC,EAAE,GAAGE;AAAL,OAAD,CAA9B;AACD,KAHD,MAGO;AACL;AACAE,MAAAA,QAAQ,CAACC,OAAT,GAAmBL,WAAW,CAACE,KAAD,CAA9B;AACD;AACF,GAdM,MAcA,IAAIC,eAAe,CAACE,OAAhB,KAA4BH,KAAhC,EAAuC;AAC5CE,IAAAA,QAAQ,CAACC,OAAT,CAAiBH,KAAjB,GAAyBA,KAAzB;AACD;;AAEDL,EAAAA,SAAS,CAAC,MAAM;AACd,WAAO,MAAM;AACX,UAAIO,QAAQ,CAACC,OAAb,EAAsB;AACpBN,QAAAA,eAAe,CAACK,QAAQ,CAACC,OAAV,CAAf;AACD;AACF,KAJD;AAKD,GANQ,EAMN,EANM,CAAT,CA3BsD,CAmCtD;;AACA,8BAAOD,QAAQ,CAACC,OAAhB,iEAA2BH,KAA3B;AACD,CAvCM","sourcesContent":["import { useEffect, useRef } from 'react';\nimport Animated, {\n  cancelAnimation,\n  makeMutable,\n} from 'react-native-reanimated';\nimport type { Primitive } from '../types';\n\nexport const useReactiveSharedValue = <T>(\n  value: T\n): T extends Primitive ? Animated.SharedValue<T> : T => {\n  const initialValueRef = useRef<T>(null);\n  const valueRef = useRef<Animated.SharedValue<T>>(null);\n\n  if (value && typeof value === 'object' && 'value' in value) {\n    /**\n     * if provided value is a shared value,\n     * then we do not initialize another one.\n     */\n  } else if (valueRef.current === null) {\n    // @ts-ignore\n    initialValueRef.current = value;\n    /**\n     * if value is an object, then we need to\n     * pass a clone.\n     */\n    if (typeof value === 'object') {\n      // @ts-ignore\n      valueRef.current = makeMutable({ ...value });\n    } else {\n      // @ts-ignore\n      valueRef.current = makeMutable(value);\n    }\n  } else if (initialValueRef.current !== value) {\n    valueRef.current.value = value as T;\n  }\n\n  useEffect(() => {\n    return () => {\n      if (valueRef.current) {\n        cancelAnimation(valueRef.current);\n      }\n    };\n  }, []);\n\n  // @ts-ignore\n  return valueRef.current ?? value;\n};\n"]}