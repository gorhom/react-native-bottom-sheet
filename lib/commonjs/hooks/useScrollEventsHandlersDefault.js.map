{"version":3,"sources":["useScrollEventsHandlersDefault.ts"],"names":["useScrollEventsHandlersDefault","scrollableRef","scrollableContentOffsetY","animatedSheetState","animatedScrollableState","animatedAnimationState","animatedScrollableContentOffsetY","rootScrollableContentOffsetY","handleOnScroll","_","context","value","SHEET_STATE","EXTENDED","FILL_PARENT","shouldLockInitialPosition","SCROLLABLE_STATE","LOCKED","lockPosition","initialContentOffsetY","handleOnBeginDrag","contentOffset","y","handleOnEndDrag","ANIMATION_STATE","RUNNING","handleOnMomentumEnd"],"mappings":"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","sourcesContent":["import { scrollTo, useWorkletCallback } from 'react-native-reanimated';\nimport { useBottomSheetInternal } from './useBottomSheetInternal';\nimport { ANIMATION_STATE, SCROLLABLE_STATE, SHEET_STATE } from '../constants';\nimport type {\n  ScrollEventsHandlersHookType,\n  ScrollEventHandlerCallbackType,\n} from '../types';\n\nexport type ScrollEventContextType = {\n  initialContentOffsetY: number;\n  shouldLockInitialPosition: boolean;\n};\n\nexport const useScrollEventsHandlersDefault: ScrollEventsHandlersHookType = (\n  scrollableRef,\n  scrollableContentOffsetY\n) => {\n  // hooks\n  const {\n    animatedSheetState,\n    animatedScrollableState,\n    animatedAnimationState,\n    animatedScrollableContentOffsetY: rootScrollableContentOffsetY,\n  } = useBottomSheetInternal();\n\n  //#region callbacks\n  const handleOnScroll: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      (_, context) => {\n        /**\n         * if sheet position is extended or fill parent, then we reset\n         * `shouldLockInitialPosition` value to false.\n         */\n        if (\n          animatedSheetState.value === SHEET_STATE.EXTENDED ||\n          animatedSheetState.value === SHEET_STATE.FILL_PARENT\n        ) {\n          context.shouldLockInitialPosition = false;\n        }\n\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = lockPosition;\n          return;\n        }\n      },\n      [\n        scrollableRef,\n        scrollableContentOffsetY,\n        animatedScrollableState,\n        animatedSheetState,\n      ]\n    );\n  const handleOnBeginDrag: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        scrollableContentOffsetY.value = y;\n        rootScrollableContentOffsetY.value = y;\n        context.initialContentOffsetY = y;\n\n        /**\n         * if sheet position not extended or fill parent and the scrollable position\n         * not at the top, then we should lock the initial scrollable position.\n         */\n        if (\n          animatedSheetState.value !== SHEET_STATE.EXTENDED &&\n          animatedSheetState.value !== SHEET_STATE.FILL_PARENT &&\n          y > 0\n        ) {\n          context.shouldLockInitialPosition = true;\n        } else {\n          context.shouldLockInitialPosition = false;\n        }\n      },\n      [\n        scrollableContentOffsetY,\n        animatedSheetState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  const handleOnEndDrag: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = lockPosition;\n          return;\n        }\n        if (animatedAnimationState.value !== ANIMATION_STATE.RUNNING) {\n          scrollableContentOffsetY.value = y;\n          rootScrollableContentOffsetY.value = y;\n        }\n      },\n      [\n        scrollableRef,\n        scrollableContentOffsetY,\n        animatedAnimationState,\n        animatedScrollableState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  const handleOnMomentumEnd: ScrollEventHandlerCallbackType<ScrollEventContextType> =\n    useWorkletCallback(\n      ({ contentOffset: { y } }, context) => {\n        if (animatedScrollableState.value === SCROLLABLE_STATE.LOCKED) {\n          const lockPosition = context.shouldLockInitialPosition\n            ? context.initialContentOffsetY ?? 0\n            : 0;\n          // @ts-ignore\n          scrollTo(scrollableRef, 0, lockPosition, false);\n          scrollableContentOffsetY.value = 0;\n          return;\n        }\n        if (animatedAnimationState.value !== ANIMATION_STATE.RUNNING) {\n          scrollableContentOffsetY.value = y;\n          rootScrollableContentOffsetY.value = y;\n        }\n      },\n      [\n        scrollableContentOffsetY,\n        scrollableRef,\n        animatedAnimationState,\n        animatedScrollableState,\n        rootScrollableContentOffsetY,\n      ]\n    );\n  //#endregion\n\n  return {\n    handleOnScroll,\n    handleOnBeginDrag,\n    handleOnEndDrag,\n    handleOnMomentumEnd,\n  };\n};\n"]}